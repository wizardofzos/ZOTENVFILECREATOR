# envding

envding is a Python script that creates an envfile for ZOSOpenTools tools based on your default environment variables and the ones set by the .bootenv file generated by zopen.

## Requirements

You must install the ZOSOpenTools via https://github.com/ZOSOpenTools/meta/releases/latest and ensure that all the binaries work. 

## Usage

1. Log off from z/OS
2. Log on to z/OS (ssh)
3. Execute "export > pre"
4. Activate the ZOT environment via `. /path/to/.bootenv`
5. Execute "export > post"
6. Transfer these two files (ASCII) to the machine that can run this script
7. Execute "./envding.py --pre=pre --post=post --envfile=.zotboot"
8. Transfer the created .zotboot to z/OS (ASCII)
9. Use the resulting output as a 'quicker' envfile to be sourced on your z/OS
10. Or source that file from /etc/profile to enable it for all your users. If you do, make sure to 'disable' that when generating a new envfile via this tool.


## Arguments

The script takes the following arguments:

* `--pre` (default: 'pre'): Filename of your environment settings before sourcing .bootenv
* `--post` (default: 'post'): Filename of your environment settings after sourcing .bootenv
* `--envfile` (default: '.zotboot'): Filename of your new environment file

## Requirements

envding requires python 3.x

## Error messages

A S013-18 will be thrown if you specify non-existing pre or post files.

### Example output

#### help
    henri@proudmoore:~/repos/ZOTENVFILECREATOR$ ./envding --help
    usage: envding [-h] [--pre PRE] [--post POST] [--envfile ENVFILE]

#### running it 

    $ ./envding --pre=pre --post=post --envfile=.zotboot
    Comparing environment variables in original 'pre' and zot-added 'post' to see what our new envfile should look like...
    - ASCII_TERMINFO:  new envvar so we bring to .zotboot
    - BASH_HOME:  new envvar so we bring to .zotboot
    - BZIP2_HOME:  new envvar so we bring to .zotboot
    - CLASSPATH:  same in both files, no need to go to .zotboot
    - COREUTILS_HOME:  new envvar so we bring to .zotboot
    - CURL_HOME:  new envvar so we bring to .zotboot
    - DBB_CONF:  same in both files, no need to go to .zotboot
    - DBB_HOME:  same in both files, no need to go to .zotboot
    - DIFFUTILS_HOME:  new envvar so we bring to .zotboot
    - FINDUTILS_HOME:  new envvar so we bring to .zotboot
    - GAWK_HOME:  new envvar so we bring to .zotboot
    - GIT_EXEC_PATH:  new envvar so we bring to .zotboot
    - GIT_HOME:  new envvar so we bring to .zotboot
    - GIT_SSL_CAINFO:  new envvar so we bring to .zotboot
    - GIT_TEMPLATE_DIR:  new envvar so we bring to .zotboot
    - GREP_HOME:  new envvar so we bring to .zotboot
    - GZIP_HOME:  new envvar so we bring to .zotboot
    - HOME:  same in both files, no need to go to .zotboot
    - JAVA_HOME:  same in both files, no need to go to .zotboot
    - JQ_HOME:  new envvar so we bring to .zotboot
    - LANG:  same in both files, no need to go to .zotboot
    - LESS_HOME:  new envvar so we bring to .zotboot
    - LIBPATH:  different in new envrionment, checking for new values
        - found new value: /zot/boot/man-db-2.10.2/lib
        - found new value: /zot/boot/ncurses-6.3/lib
        - found new value: /zot/boot/bzip2-1.0.8/lib
        - found new value: /zot/boot/xz-5.2.5/lib
        - found new value: /zot/boot/jq-1.6/lib
        - found new value: /zot/boot/perl5-blead/lib/5.37.10/os390/CORE
        - found new value: /zot/boot/perl5-blead/lib
        - found new value: /zot/boot/curl-7.83.1/lib
    - LOGNAME:  skipping
    - MAIL:  skipping
    - MAKE_HOME:  new envvar so we bring to .zotboot
    - MANPATH:  different in new envrionment, checking for new values
        - found new value: /zot/boot/man-db-2.10.2/share/man
        - found new value: /zot/boot/gawk-5.1.1.20230209_233220.zos/share/man
        - found new value: /zot/boot/grep-3.8.20230131_135248.zos/share/man
        - found new value: /zot/boot/sed-4.8/share/man
        - found new value: /zot/boot/ncurses-6.3/share/man
        - found new value: /zot/boot/vim-heads.v9.0.0846/share/man
        - found new value: /zot/boot/xz-5.2.5/share/man
        - found new value: /zot/boot/gzip-1.12/share/man
        - found new value: /zot/boot/tar-1.34/share/man
        - found new value: /zot/boot/coreutils-9.1/share/man
        - found new value: /zot/boot/findutils-4.9.0/share/man
        - found new value: /zot/boot/diffutils-3.8/share/man
        - found new value: /zot/boot/bash-5.2/share/man
        - found new value: /zot/boot/jq-1.6/share/man
        - found new value: /zot/boot/less-608.zos/share/man
        - found new value: /zot/boot/make-4.4.0.90/share/man
        - found new value: /zot/boot/curl-7.83.1/share/man
    - MAN_HOME:  new envvar so we bring to .zotboot
    - MAN_TEST_DISABLE_SYSTEM_CONFIG:  new envvar so we bring to .zotboot
    - META_HOME:  new envvar so we bring to .zotboot
    - NCURSES_HOME:  new envvar so we bring to .zotboot
    - NLSPATH:  same in both files, no need to go to .zotboot
    - OPENSSL_CONF:  same in both files, no need to go to .zotboot
    - PATH:  different in new envrionment, checking for new values
        - found new value: /zot/boot/man-db-2.10.2/bin
        - found new value: /zot/boot/gawk-5.1.1.20230209_233220.zos/bin
        - found new value: /zot/boot/grep-3.8.20230131_135248.zos/bin
        - found new value: /zot/boot/sed-4.8/bin
        - found new value: /zot/boot/ncurses-6.3/bin
        - found new value: /zot/boot/vim-heads.v9.0.0846/bin
        - found new value: /zot/boot/bzip2-1.0.8/bin
        - found new value: /zot/boot/xz-5.2.5/bin
        - found new value: /zot/boot/gzip-1.12/bin
        - found new value: /zot/boot/tar-1.34/bin
        - found new value: /zot/boot/coreutils-9.1/bin
        - found new value: /zot/boot/findutils-4.9.0/bin
        - found new value: /zot/boot/diffutils-3.8/bin
        - found new value: /zot/boot/bash-5.2/bin
        - found new value: /zot/boot/jq-1.6/bin
        - found new value: /zot/boot/perl5-blead/bin
        - found new value: /zot/boot/less-608.zos/bin
        - found new value: /zot/boot/git-2.39.1/bin
        - found new value: /zot/boot/make-4.4.0.90/bin
        - found new value: /zot/boot/curl-7.83.1/bin
        - found new value: /zot/boot/meta-main/bin
    - PERL5LIB:  new envvar so we bring to .zotboot
    - PERL5_HOME:  new envvar so we bring to .zotboot
    - PS1:  skipping
    - SED_HOME:  new envvar so we bring to .zotboot
    - SHELL:  skipping
    - SSH_CLIENT:  skipping
    - SSH_CONNECTION:  skipping
    - SSH_TTY:  skipping
    - SSL_CERT_FILE:  new envvar so we bring to .zotboot
    - TAR_HOME:  new envvar so we bring to .zotboot
    - TERM:  same in both files, no need to go to .zotboot
    - TZ:  same in both files, no need to go to .zotboot
    - USER:  skipping
    - VIM:  new envvar so we bring to .zotboot
    - VIM_HOME:  new envvar so we bring to .zotboot
    - XZ_HOME:  new envvar so we bring to .zotboot
    - ZOAU_HOME:  same in both files, no need to go to .zotboot
    - _:  skipping
    - _BPXK_AUTOCVT:  same in both files, no need to go to .zotboot
    - _CEE_RUNOPTS:  new envvar so we bring to .zotboot
    - _TAG_REDIR_ERR:  new envvar so we bring to .zotboot
    - _TAG_REDIR_IN:  new envvar so we bring to .zotboot
    - _TAG_REDIR_OUT:  new envvar so we bring to .zotboot

    New envfile written to .zotboot.

    Transfer this to z/OS (ASCII) to source it directly.
    Make sure to rerun this procedure after installing new ZOSOpenTools or moving them.

    Don't add this to /etc/profile to enable ZOSOpenTools for all your users, 
    but rather add a single line to source this file from the /etc/profile.

    That way you can remove that line to regenerate it after updates to ZOSOpenTools
